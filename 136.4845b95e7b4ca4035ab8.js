"use strict";(self.webpackChunkcalculator=self.webpackChunkcalculator||[]).push([[136],{471:(e,t,s)=>{s.r(t),s.d(t,{default:()=>T,getDefaultSetItem:()=>j,getStorageBonusSets:()=>O,isArrayLikeBonusGroup:()=>I});var a=s(893),n=s(294);const r="iM4Sf1YT";var i=s(828),l=s(181);var o=s(612);const c="ZcaWq7O2",u="IGpuRSmZ",d="jDlxYzT7";var p=s(760),h=s(814),m=s(245),f=s(843),g=s(203);let y=[];function v(e,t){for(const s of t)e.push((0,a.jsx)("option",{value:s,children:g.Z.en[s]},s))}function b(e){const t=[];if(e)for(const s of e)t.push((0,a.jsx)("option",{value:s,children:g.Z.en[s]},s));return t}v(y,[...o.IB]),v(y,[...p.vW]),v(y,[...o.CV]);const k=e=>{const t=(0,h.hU)(e.set.key);let s=t?parseFloat((100*e.set.value).toFixed(2)):e.set.value,r=0,i=[],l=[];const o="dmgIncrease"===e.set.key||"dmgTakenIncrease"===e.set.key||"elemIncrease"===e.set.key||"resPen"===e.set.key||"resReduction"===e.set.key;o&&(i=b([...h.xw]),l=b("dot"===e.set.atkTypeOption?[...h.YU]:[...h.U6]));const p=t?(0,a.jsx)(f.E,{}):(0,a.jsx)(n.Fragment,{}),g=t?void 0:{width:"8.5em"};return(0,a.jsxs)("div",{className:"VaKqXHgu",children:[(0,a.jsxs)("div",{className:c,children:[(0,a.jsx)("section",{className:u,children:(0,a.jsx)("select",{value:e.set.key,className:"A8SUHbjF",onInput:t=>{t.persist(),e.changeCallback(e.set.id,t.currentTarget.value,void 0,void 0,void 0)},children:y},"main"+r++)}),(0,a.jsxs)("section",{className:u,children:[(0,a.jsx)("input",{style:g,value:s,className:"Tkd8Cb7k",type:"number",placeholder:"0",onKeyDown:e=>{m.q.isValidKeyInput(e.key,t)||e.preventDefault()},onChange:s=>{const a=function(e,t){return m.$.getValidatedStatData(e,t)}(s.target.value,t);s.target.value=a.valueAsString,e.changeCallback(e.set.id,void 0,Number(a.valueAsNumber)??0,void 0,void 0)}},"value"+r++),p]})]}),(0,a.jsx)("button",{className:"w0NVpLFW",onClick:t=>e.clearCallback(e.set.id),children:"x"}),o?(0,a.jsxs)("div",{className:c,children:[(0,a.jsx)("section",{className:u,children:(0,a.jsx)("select",{value:e.set.atkTypeOption,className:d,disabled:0===i.length,onInput:t=>{t.persist(),e.changeCallback(e.set.id,void 0,void 0,t.currentTarget.value,void 0)},children:i},"add"+r++)}),(0,a.jsx)("section",{className:u,children:(0,a.jsx)("select",{value:e.set.elemTypeOption,className:d,disabled:0===l.length,onInput:t=>{t.persist(),e.changeCallback(e.set.id,void 0,void 0,void 0,t.currentTarget.value)},children:l},"add"+r++)})]}):(0,a.jsx)(n.Fragment,{})]})},N=e=>{const t=function(e){let t=0;if(e&&e.set&&Object.keys(e.set).length>0){let s=[];for(const n of e.set)s.push((0,a.jsx)(k,{set:{...n},changeCallback:e.addBonusCallback,clearCallback:e.deleteBonusCallback},`item-${t}`)),t++;return s}return[]}(e),s=(0,n.useRef)(null),r=j();return(0,n.useEffect)((()=>{const e=s.current?.scrollHeight;s.current?.scrollTo(0,e)}),[e]),(0,a.jsxs)("div",{className:"kZBiILxd",children:[(0,a.jsx)("p",{className:"_hoVUm_0",children:"Edit set:"}),(0,a.jsxs)("div",{className:"OSAdLtG_",ref:s,children:[t,(0,a.jsx)("button",{onClick:()=>e.addBonusCallback(e.set.length,r.key,r.value,r.atkTypeOption,r.elemTypeOption),children:"Add"})]})]})};var w=s(268),x=s(227),S=s(773);(0,s(543).N)();const j=(e=0)=>({id:e,key:"dmgIncrease",value:1,atkTypeOption:"any",elemTypeOption:"all"});function I(e){return Array.isArray(e)&&(e.every((e=>"string"==typeof e[0]&&(0,w.XH)(e[1])))||0===e.length)}function O(){let e=new S.M;for(const t of x.B)if(localStorage.getItem(i.Z+t)){const s=JSON.parse(localStorage.getItem(i.Z+t));if(I(s)){const a=new Map(s);e.setGroupMap(t,a)}}return e}const T=()=>{const[e,t]=(0,n.useState)(O()),[s,o]=(0,n.useState)([j()]),c=()=>{t((()=>O()))};return(0,a.jsx)("div",{className:"Non7k_5S",children:(0,a.jsxs)("div",{className:"_vH_XDO1",children:[(0,a.jsxs)("div",{className:r,children:[(0,a.jsx)(i.o,{set:s,updateCallback:c}),(0,a.jsx)(l.Cg,{provider:e,loadCallback:e=>{o(e)},updateCallback:c})]}),(0,a.jsx)("div",{className:r,children:(0,a.jsx)(N,{set:s,addBonusCallback:(e,t,s,a,n)=>{(t||!Number.isNaN(Number(s))||a||n)&&o((r=>(0,w.wu)(r,e,t,s,a,n)))},deleteBonusCallback:e=>{Number.isNaN(Number(e))||o((t=>{const s=t.findIndex((t=>t.id===e));if(-1===s)return console.log("There's no bonus to delete"),t;let a=[...t];a.splice(s,1);let n=0;return console.log(a),a=a.map((e=>({...e,id:n++}))),console.log(a),a}))}})})]})})}},828:(e,t,s)=>{s.d(t,{o:()=>o,Z:()=>l});var a=s(893),n=s(294);var r=s(227),i=(s(268),s(471));const l="bonusset-",o=e=>{const t=(0,n.useRef)(null),s=(0,n.useRef)(null);let o=[];for(const e of r.B)o.push((0,a.jsx)("option",{value:e,children:e},e));return(0,a.jsxs)("div",{className:"vSLIrJuG",children:[(0,a.jsx)("p",{className:"ElObydME",children:"Save set:"}),(0,a.jsxs)("div",{className:"U0roux2R",children:[(0,a.jsxs)("select",{ref:t,defaultValue:"none",children:[(0,a.jsx)("option",{hidden:!0,disabled:!0,value:"none",children:"-select type-"}),o]}),(0,a.jsx)("input",{ref:s,maxLength:20,type:"text",placeholder:"Type the name of set"}),(0,a.jsx)("button",{onClick:a=>{t.current&&"none"!==t.current.value||console.log("Please select the type of set!"),s.current&&""!==s.current.value||console.log("Please input the name of set!"),e.set&&0!==e.set.length||console.log("Current set is invalid");const n=t.current.value,r=localStorage.getItem(l+n);let o;if(r){const e=JSON.parse(r);(0,i.isArrayLikeBonusGroup)(e)&&(o=new Map(e))}else o=new Map;const c=s.current.value.trim();if(o.has(c)&&!confirm("Current set already exists. Do you want to override it?"))return;const u={name:c,type:n,items:e.set};o.set(c,u);const d=Array.from(o),p=JSON.stringify(d);localStorage.setItem(l+n,p),e.updateCallback()},children:"Save"})]})]})}},181:(e,t,s)=>{s.d(t,{Cg:()=>f,AA:()=>m,_K:()=>h});var a=s(893);const n="EAbruiUR";var r=s(203),i=s(294),l=s(828),o=s(227),c=s(773),u=s(471),d=s(394),p=s(268);function h(e){return e?e.multiple?(console.log("getSelectorGroupName is working only with non-multiple select element"),null):e.selectedOptions[0]?.parentElement instanceof HTMLOptGroupElement?{groupName:e.selectedOptions[0].parentElement.id,name:e.selectedOptions[0].value}:(console.log("Something went wrong in 'getSelectorGroupName' function"),{groupName:null,name:null}):(console.log("Parameter is invalid in getSelectorGroupName"),null)}function m(e,t){const s=[];return e.data.forEach(((e,n)=>{if(!t||t.includes(n)||0===t.length){const t=[];e.forEach(((e,s)=>{t.push((0,a.jsx)("option",{value:s,children:s},s))})),s.push((0,a.jsx)("optgroup",{id:n,label:r.Z.en[n],children:t},n))}})),s}const f=e=>{const t=(0,i.useRef)(null),s=m(e.provider)??[];return(0,a.jsxs)("div",{className:"e8819BNZ",children:[(0,a.jsx)("p",{className:"GLlbHPAN",children:"Your sets:"}),(0,a.jsxs)("div",{className:"XN7ZxQBF",children:[(0,a.jsxs)("div",{className:n,children:[(0,a.jsx)("button",{onClick:async t=>{let s;try{s=await(0,d.Dq)(!1,600)}catch(e){return void console.log(e)}if(!s||!s[0])return;let a,n,r=(0,u.getStorageBonusSets)();try{a=await(0,d.$4)(s[0])}catch(e){return void console.log(e)}if(a&&0!==a.length){try{const e=c.M.parse(a);n=c.M.isTypes(e,o.F,p.XH)?e:void 0}catch(e){return void console.log("Wrong type of file!")}if(confirm('Do you want to SAVE all your previous setups?\n"OK" to ADD new setups, "Cancel" to CLEAR and ADD')){const e=confirm('Do you want to override setups on name conflict?\n"Cancel" to add with new names');n.data.forEach(((t,s)=>{t.forEach(((t,a)=>{let n=a;e||(n=function(e,t,s){let a=t,n=0;for(;e.getElement(a,s);){if(n>999)throw new Error("Something went wrong with indexing new setup");n++,a=t.concat("(",n.toString(),")")}return a}(r,a,s)),r.setObject(t,s,n)}))}))}else r=new c.M(n);r.data.forEach(((e,t)=>{const s=Array.from(e),a=JSON.stringify(s);localStorage.setItem(l.Z+t,a)})),e.updateCallback()}else alert("There is nothing to import")},children:"Import"}),(0,a.jsx)("button",{onClick:()=>{const e=(0,u.getStorageBonusSets)();if(0===e.data.size)return;const t=c.M.toArray(e),s=JSON.stringify(t);let a=new File([s],"bonuses.json",{type:"text/plain:charset=UTF-8"});(0,d.Xo)(a)},children:"Export"}),(0,a.jsx)("button",{onClick:()=>{confirm("Do you want to DELETE ALL your bonuses?")&&o.B.forEach((e=>{localStorage.removeItem(l.Z+e)})),e.updateCallback()},children:"Clear"})]}),(0,a.jsxs)("div",{className:n,children:[(0,a.jsx)("button",{onClick:()=>{const{groupName:s,name:a}=h(t.current);if(s&&a&&e.provider.getElement(a,s)){const t=e.provider.getElement(a,s);t&&confirm("Do you want to load set? It will reset current preset.")&&e.loadCallback(t.items)}},children:"Load"}),(0,a.jsx)("button",{onClick:()=>{const{groupName:s,name:a}=h(t.current);if(s&&a){const t=localStorage.getItem(l.Z+s),n=JSON.parse(t);if(!(0,u.isArrayLikeBonusGroup)(n))return;const r=new Map(n);if(r.delete(a)&&0!==r.size){const e=JSON.stringify(Array.from(r));localStorage.setItem(l.Z+s,e)}else 0===r.size&&localStorage.removeItem(l.Z+s);e.updateCallback()}},children:"Delete"})]})]}),(0,a.jsx)("select",{ref:t,className:"On3iX0ix",name:"fruit",size:10,children:s})]})}},394:(e,t,s)=>{s.d(t,{$4:()=>i,Dq:()=>l,Pc:()=>a,Xo:()=>r,iy:()=>n});const a="setups";function n(){const e=localStorage.getItem(a);if(!e)return console.log("There is no setups yet"),{};const t=JSON.parse(e);return t&&0!==Object.keys(t).length?t:(console.log("There is no setups yet"),{})}function r(e){const t=window.URL.createObjectURL(e),s=document.createElement("a");s.setAttribute("style","display: none"),s.href=t,s.download=e.name,s.click(),window.URL.revokeObjectURL(t),s.remove()}function i(e){return new Promise(((t,s)=>{const a=new FileReader;a.onloadend=e=>{const s=e.target.result;t(s)},a.onerror=e=>{s(e)},a.readAsText(e)}))}function l(e=!1,t=10){const s=document.createElement("input");let a;return s.type="file",s.accept=".json",s.multiple=e,s.click(),new Promise(((e,n)=>{s.addEventListener("change",(()=>e(s.files))),s.addEventListener("cancel",(()=>e(null))),a=setTimeout((()=>{n()}),1e3*t)})).finally((()=>{s.remove(),clearTimeout(a)}))}},612:(e,t,s)=>{s.d(t,{CV:()=>a,IB:()=>n,zk:()=>r});const a=["baseatk","basehp","basedef"],n=["crrate","crdmg","atkIncrease","hpIncrease","defIncrease","flatatk","flathp","flatdef","dmgIncrease","elemIncrease","defIgnore","resPen"];class r{constructor(e="basic",t="fire",s="atk",a={multiplier:0,baseatk:0,basehp:0,basedef:0},n={crrate:.05,crdmg:.5,flatatk:352,flathp:0,flatdef:0,breakeffect:0,atkIncrease:0,hpIncrease:0,defIncrease:0,elemIncrease:0,dmgIncrease:0,defIgnore:0,resPen:0}){this.atkType=e??"basic",this.element=t??"fire",this.srcStat=s??"atk";for(const e of Object.keys({multiplier:0,baseatk:0,basehp:0,basedef:0}))void 0===a[e]&&(a[e]=0);this.stats=a;for(const e of Object.keys({crrate:.05,crdmg:.5,flatatk:352,flathp:0,flatdef:0,breakeffect:0,atkIncrease:0,hpIncrease:0,defIncrease:0,elemIncrease:0,dmgIncrease:0,defIgnore:0,resPen:0}))void 0===n[e]&&(n[e]=0,console.log());this.buffs=n}getCharObj(){return{atkType:this.atkType,element:this.element,srcStat:this.srcStat,stats:this.stats,buffs:this.buffs}}getCharTotalAtk(){return Math.floor(this.stats[`base${this.srcStat}`]*(1+this.buffs[`${this.srcStat}Increase`])+this.buffs[`flat${this.srcStat}`])}}},760:(e,t,s)=>{s.d(t,{C8:()=>n,vW:()=>a});const a=["defReduction","resReduction","dmgTakenIncrease"];class n{constructor(e=95,t="fire",s={hp:0,def:0,res:0},a={defReduction:0,resReduction:0,dmgTakenIncrease:0},n=!1){this._lvl=e,this._element=t,this._stats=s,this._debuffs=a,this._isBroken=n,this.updateDefByLvl()}updateDefByLvl(){this._stats.def=200+10*this._lvl}get lvl(){return this._lvl}get element(){return this._element}get stats(){return this._stats}get debuffs(){return this._debuffs}get isBroken(){return this._isBroken}set lvl(e){this._lvl=e,this.updateDefByLvl()}set element(e){this._element=e}set stats(e){this._stats=e}set debuffs(e){this._debuffs=e}set isBroken(e){this._isBroken=e}getEnemyObj(){return{lvl:this.lvl,element:this.element,stats:this.stats,debuffs:this._debuffs,isBroken:this._isBroken}}}},843:(e,t,s)=>{s.d(t,{E:()=>n});var a=s(893);const n=e=>(0,a.jsx)("p",{className:"J6P9uriy",children:"%"})},177:(e,t,s)=>{s.d(t,{d:()=>a,l:()=>n});const a=["atk","hp","def"],n=["fire","ice","lightning","physical","quantum","imaginary","wind"]},268:(e,t,s)=>{s.d(t,{Hy:()=>o,Lx:()=>l,XH:()=>i,wu:()=>n});var a=s(814);function n(e,t,s,n,i,l){if(!s&&Number.isNaN(Number(n))&&!i&&!l||Number.isNaN(Number(t)))throw new Error("Something went wrong! origin: getBonusSet()");const o=e.find((e=>e.id===t));if(o){const c=e.indexOf(o),u=[...e],d=s??o.key;let p=Number.isNaN(Number(n))?o.value:Number(n);s&&(0,a.hU)(o.key)!==(0,a.hU)(s)&&(p=0);let h=i??o.atkTypeOption,m=l??o.elemTypeOption;if(s){const e=r(s);h=e.atkTypeOption,m=e.elemTypeOption}return"dot"!==i||a.Wv.includes(l)||(m=a.YU[0]),u[c]={id:t,key:d,value:p,atkTypeOption:h,elemTypeOption:m},u}{if(Number.isNaN(Number(t)))throw new Error("Invalid ID for new set");const a=s??"crrate",i=Number.isNaN(Number(n))?0:Number(n),l=r(s),o=l.atkTypeOption,c=l.elemTypeOption;return[...e,{id:t,key:a,value:i,atkTypeOption:o,elemTypeOption:c}]}}function r(e){if(!e)throw new Error("Invalid key");const t={atkTypeOption:"none",elemTypeOption:"none"};return"dmgIncrease"!==e&&"dmgTakenIncrease"!==e&&"elemIncrease"!==e&&"resPen"!==e&&"resReduction"!==e||(t.atkTypeOption=a.xw[0],t.elemTypeOption=a.U6[0]),t}function i(e){return e instanceof Object&&e.hasOwnProperty("name")&&e.hasOwnProperty("type")&&e.hasOwnProperty("items")}function l(e){return e instanceof Object&&e.hasOwnProperty("isActive")&&e.hasOwnProperty("comparisonValue")&&i(e)}function o(e,t,s){return{...e,isActive:t,comparisonValue:s,items:e.items.map((e=>({...e,isActive:t,comparisonValue:s})))}}},227:(e,t,s)=>{s.d(t,{B:()=>a,F:()=>n});const a=["weapon","teammate","relics","planars","other"];function n(e){return a.includes(e)}},773:(e,t,s)=>{s.d(t,{M:()=>a});class a{constructor(e){e instanceof Array?this._map=a.fromArray(e).data:e instanceof Map?this._map=e:this._map=e instanceof a?e.data:new Map}get data(){return this._map}setObject(e,t,s){this._map.has(t)||this._map.set(t,new Map),this._map.get(t).set(s,e)}setGroupMap(e,t){this._map.set(e,t)}getElement(e,t){return this._map.has(t)?this._map.get(t).get(e):void 0}getConvertedGroupedMap(e){let t=new a;return this._map.forEach(((s,a)=>{s.forEach(((s,n)=>{const r=e(s);t.setObject(r,a,n)}))})),t}static isTypes(e,t,s){if(e instanceof a)return e.data.forEach(((e,a)=>{let n=!0;if(e.forEach((e=>{s(e)||(n=!1)})),!t(a)||!n)return!1})),!0}unsetObject(e,t){return!!this.isObjExists(e,t)&&(this._map.get(e).delete(t),!0)}isObjExists(e,t){return this._map.has(e)&&this._map.get(e).has(t)}hasElement(e,t){return this._map.has(t)&&this._map.get(t).has(e)}getWith(e,t,s){return this.setObject(e,s,t),new a(this._map)}getWithout(e,t){return this.unsetObject(t,e),new a(this._map)}getGroupClone(e){return new Map(this._map.get(e))}static fromArray(e){function t(e){return Array.isArray(e)&&2===e.length}let s=new Map;try{e?.forEach((e=>{if(!t(e))throw new Error("Array value is invalid. Source: 'Groupedmap.fromArray()"+e);let a=new Map;e[1].forEach((e=>{if(!t(e))throw new Error("Array value is invalid. Source: 'Groupedmap.fromArray(). Params: "+e);a.set(e[0],e[1])})),s.set(e[0],a)}))}catch(e){console.log(e)}finally{return new a(s)}}static toArray(e){let t=[];return e.data.forEach(((e,s)=>{let a=Array.from(e);t.push([s,a])})),t}static stringify(e){const t=a.toArray(e);return JSON.stringify(t)}static parse(e){if(!e||0===e.length)return new a;const t=JSON.parse(e);return Array.isArray(t)?a.fromArray(t):new a}}},814:(e,t,s)=>{s.d(t,{U6:()=>i,Wv:()=>n,YU:()=>r,cE:()=>l,hU:()=>c,xw:()=>o});var a=s(177);const n=["fire","lightning","physical","wind"],r=["all",...n],i=["all",...a.l],l=["basic","skill","ultimate","talent","dot","follow-up"],o=["any",...l];function c(e){return!["baseatk","basehp","basedef","flatatk","flathp","flatdef","lvl","def"].includes(e)}},203:(e,t,s)=>{s.d(t,{Z:()=>a});const a={en:{multiplier:"Multiplier",atkType:"Attack type",element:"Element",srcStat:"Dmg source",baseatk:"Base Atk",basehp:"Base HP",basedef:"Base Def",crrate:"Crit.rate",crdmg:"Crit DMG",flatatk:"Flat Atk",flathp:"Flat HP",flatdef:"Flat Def",breakeffect:"Break effect",atkIncrease:"Atk%",hpIncrease:"HP%",defIncrease:"Def%",elemIncrease:"Elemental%",dmgIncrease:"Dmg%",defIgnore:"Def Ignore",resPen:"Res PEN",defReduction:"Def Reduction",resReduction:"Res Reduction",dmgTakenIncrease:"Dmg Taken%",basic:"Basic",skill:"Skill",ultimate:"Ultimate",talent:"Talent","follow-up":"Follow-up",dot:"DoT",any:"Any",fire:"Fire",lightning:"Lightning",physical:"Physical",wind:"Wind",ice:"Ice",quantum:"Quantum",imaginary:"Imaginary",all:"All",weapon:"Weapon",teammate:"Teammate",relics:"Relic",planars:"Planar",other:"Other"}}},245:(e,t,s)=>{s.d(t,{$:()=>a,q:()=>n});class a{static invalidCharsValidation(e){for(const t of this.invalidChars)e.replace(t,"");return e}static emptyValidation(e){return""===e?"0":e}static startWithZeroValidation(e){if(e.startsWith("0")&&!e.startsWith("0.")&&e.length>1){let t=1;for(;t<e.length-1&&"0"===e[t];)t++;return e.slice(t,e.length)}return e}static maxFloatLengthValidation(e){return e.split(".")[1]?.length>2&&(e=e.slice(0,e.length-1)),e.split(".")[0]?.length>6&&e.split(".")[1]&&(e=e.slice(1,e.length)),e.length>9&&(e=e.slice(0,e.length-1)),e}static maxIntegerLengthValidation(e){const t=e.indexOf("."),s=e.indexOf(",");if(-1!==t||-1!==s){const a=Math.min(-1===t?9:t,-1===s?9:s);e=e.slice(0,a)}return e.length>9&&(e=e.slice(0,e.length-1)),e}static parseStringValueToPercentFloat(e){return isNaN(Number(e))?0:Number((Number(e)/100).toFixed(4))}static parseStringValueToInteger(e){return isNaN(parseInt(e))?(console.log("Can't parse current value: "+e.toString()),0):parseInt(e)}static getValidatedStatData(e,t){return""===e?{valueAsString:"",valueAsNumber:0}:(e=a.invalidCharsValidation(e),e=a.startWithZeroValidation(e),{valueAsString:e=t?a.maxFloatLengthValidation(e):a.maxIntegerLengthValidation(e),valueAsNumber:t?a.parseStringValueToPercentFloat(e):a.parseStringValueToInteger(e)})}}a.invalidChars=["+","e","-"];class n{static isValidKeys(e){return!("-"===e||"+"===e||"e"===e)}static isValidLocaleSeparator(e){const t=n.localeDecimalSeparator;return!(("."===e||","===e)&&t!==e)}static isValidFormat(e,t){return!(n.localeDecimalSeparator===e&&!t)}static isValidKeyInput(e,t){return n.isValidKeys(e)&&n.isValidLocaleSeparator(e)&&n.isValidFormat(e,t)}}n.localeDecimalSeparator=1.1.toLocaleString().substring(1,2)},543:(e,t,s)=>{function a(){const e="version";localStorage.getItem(e)?.split(".")[0]!=="1.0.1".split(".")[0]&&(localStorage.clear(),localStorage.setItem(e,"1.0.1"))}s.d(t,{N:()=>a})}}]);
//# sourceMappingURL=136.4845b95e7b4ca4035ab8.js.map