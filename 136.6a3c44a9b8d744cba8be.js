"use strict";(self.webpackChunkcalculator=self.webpackChunkcalculator||[]).push([[136],{471:(e,t,a)=>{a.r(t),a.d(t,{default:()=>C,getDefaultSetItem:()=>I,getStorageBonusSets:()=>O,isArrayLikeBonusGroup:()=>j});var s=a(893),n=a(294);const r="iM4Sf1YT";var i=a(828),l=a(181);var o=a(612);const c="ZcaWq7O2",u="IGpuRSmZ",d="jDlxYzT7";var h=a(760),p=a(814),m=a(245),f=a(843),g=a(203);let y=[];function v(e,t){for(const a of t)e.push((0,s.jsx)("option",{value:a,children:g.Z.en[a]},a))}function b(e){const t=[];if(e)for(const a of e)t.push((0,s.jsx)("option",{value:a,children:g.Z.en[a]},a));return t}v(y,[...o.IB]),v(y,[...h.vW]),v(y,[...o.CV]);const k=e=>{const t=(0,p.hU)(e.set.key);let a=t?parseFloat((100*e.set.value).toFixed(2)):e.set.value,r=0,i=[],l=[];const o="dmgIncrease"===e.set.key||"dmgTakenIncrease"===e.set.key||"elemIncrease"===e.set.key||"resPen"===e.set.key||"resReduction"===e.set.key;o&&(i=b([...p.xw]),l=b("dot"===e.set.atkTypeOption?[...p.YU]:[...p.U6]));const h=t?(0,s.jsx)(f.E,{}):(0,s.jsx)(n.Fragment,{}),g=t?void 0:{width:"8.5em"};return(0,s.jsxs)("div",{className:"VaKqXHgu",children:[(0,s.jsxs)("div",{className:c,children:[(0,s.jsx)("section",{className:u,children:(0,s.jsx)("select",{value:e.set.key,className:"A8SUHbjF",onInput:t=>{t.persist(),e.changeCallback(e.set.id,t.currentTarget.value,void 0,void 0,void 0)},children:y},"main"+r++)}),(0,s.jsxs)("section",{className:u,children:[(0,s.jsx)("input",{style:g,value:a,className:"Tkd8Cb7k",type:"number",placeholder:"0",onKeyDown:e=>{m.q.isValidKeyInput(e.key,t)||e.preventDefault()},onChange:a=>{const s=function(e,t){return m.$.getValidatedStatData(e,t)}(a.target.value,t);a.target.value=s.valueAsString,e.changeCallback(e.set.id,void 0,Number(s.valueAsNumber)??0,void 0,void 0)}},"value"+r++),h]})]}),(0,s.jsx)("button",{className:"w0NVpLFW",onClick:t=>e.clearCallback(e.set.id),children:"x"}),o?(0,s.jsxs)("div",{className:c,children:[(0,s.jsx)("section",{className:u,children:(0,s.jsx)("select",{value:e.set.atkTypeOption,className:d,disabled:0===i.length,onInput:t=>{t.persist(),e.changeCallback(e.set.id,void 0,void 0,t.currentTarget.value,void 0)},children:i},"add"+r++)}),(0,s.jsx)("section",{className:u,children:(0,s.jsx)("select",{value:e.set.elemTypeOption,className:d,disabled:0===l.length,onInput:t=>{t.persist(),e.changeCallback(e.set.id,void 0,void 0,void 0,t.currentTarget.value)},children:l},"add"+r++)})]}):(0,s.jsx)(n.Fragment,{})]})},N=e=>{const t=function(e){let t=0;if(e&&e.set&&Object.keys(e.set).length>0){let a=[];for(const n of e.set)a.push((0,s.jsx)(k,{set:{...n},changeCallback:e.addBonusCallback,clearCallback:e.deleteBonusCallback},`item-${t}`)),t++;return a}return[]}(e),a=(0,n.useRef)(null),r=I();return(0,n.useEffect)((()=>{const e=a.current?.scrollHeight;a.current?.scrollTo(0,e)}),[e]),(0,s.jsxs)("div",{className:"kZBiILxd",children:[(0,s.jsx)("p",{className:"_hoVUm_0",children:"Edit set:"}),(0,s.jsxs)("div",{className:"OSAdLtG_",ref:a,children:[t,(0,s.jsx)("button",{onClick:()=>e.addBonusCallback(e.set.length,r.key,r.value,r.atkTypeOption,r.elemTypeOption),children:"Add"})]})]})};var x=a(268),w=a(227),S=a(773);(0,a(543).N)();const I=(e=0)=>({id:e,key:"dmgIncrease",value:1,atkTypeOption:"any",elemTypeOption:"all"});function j(e){return Array.isArray(e)&&(e.every((e=>"string"==typeof e[0]&&(0,x.XH)(e[1])))||0===e.length)}function O(){let e=new S.M;for(const t of w.B)if(localStorage.getItem(i.Z+t)){const a=JSON.parse(localStorage.getItem(i.Z+t));if(j(a)){const s=new Map(a);e.setGroupMap(t,s)}}return e}const C=()=>{const[e,t]=(0,n.useState)(O()),[a,o]=(0,n.useState)([I()]),c=()=>{t((()=>O()))};return(0,s.jsx)("div",{className:"Non7k_5S",children:(0,s.jsxs)("div",{className:"_vH_XDO1",children:[(0,s.jsxs)("div",{className:r,children:[(0,s.jsx)(i.o,{set:a,updateCallback:c}),(0,s.jsx)(l.Cg,{provider:e,loadCallback:e=>{o(e)},updateCallback:c})]}),(0,s.jsx)("div",{className:r,children:(0,s.jsx)(N,{set:a,addBonusCallback:(e,t,a,s,n)=>{(t||!Number.isNaN(Number(a))||s||n)&&o((r=>(0,x.wu)(r,e,t,a,s,n)))},deleteBonusCallback:e=>{Number.isNaN(Number(e))||o((t=>{const a=t.findIndex((t=>t.id===e));if(-1===a)return console.log("There's no bonus to delete"),t;let s=[...t];s.splice(a,1);let n=0;return console.log(s),s=s.map((e=>({...e,id:n++}))),console.log(s),s}))}})})]})})}},828:(e,t,a)=>{a.d(t,{o:()=>o,Z:()=>l});var s=a(893),n=a(294);var r=a(227),i=(a(268),a(471));const l="bonusset-",o=e=>{const t=(0,n.useRef)(null),a=(0,n.useRef)(null);let o=[];for(const e of r.B)o.push((0,s.jsx)("option",{value:e,children:e},e));return(0,s.jsxs)("div",{className:"vSLIrJuG",children:[(0,s.jsx)("p",{className:"ElObydME",children:"Save set:"}),(0,s.jsxs)("div",{className:"U0roux2R",children:[(0,s.jsxs)("select",{ref:t,defaultValue:"none",children:[(0,s.jsx)("option",{hidden:!0,disabled:!0,value:"none",children:"-select type-"}),o]}),(0,s.jsx)("input",{ref:a,maxLength:20,type:"text",placeholder:"Type the name of set"}),(0,s.jsx)("button",{onClick:s=>{t.current&&"none"!==t.current.value||console.log("Please select the type of set!"),a.current&&""!==a.current.value||console.log("Please input the name of set!"),e.set&&0!==e.set.length||console.log("Current set is invalid");const n=t.current.value,r=localStorage.getItem(l+n);let o;if(r){const e=JSON.parse(r);(0,i.isArrayLikeBonusGroup)(e)&&(o=new Map(e))}else o=new Map;const c=a.current.value.trim();if(o.has(c)&&!confirm("Current set already exists. Do you want to override it?"))return;const u={name:c,type:n,items:e.set};o.set(c,u);const d=Array.from(o),h=JSON.stringify(d);localStorage.setItem(l+n,h),e.updateCallback()},children:"Save"})]})]})}},181:(e,t,a)=>{a.d(t,{Cg:()=>f,AA:()=>m,_K:()=>p});var s=a(893);const n="EAbruiUR";var r=a(203),i=a(294),l=a(828),o=a(227),c=a(773),u=a(471),d=a(394),h=a(268);function p(e){return e?e.multiple?(console.log("getSelectorGroupName is working only with non-multiple select element"),null):e.selectedOptions[0]?.parentElement instanceof HTMLOptGroupElement?{groupName:e.selectedOptions[0].parentElement.id,name:e.selectedOptions[0].value}:(console.log("Something went wrong in 'getSelectorGroupName' function"),{groupName:null,name:null}):(console.log("Parameter is invalid in getSelectorGroupName"),null)}function m(e,t){const a=[];return e.data.forEach(((e,n)=>{if(!t||t.includes(n)||0===t.length){const t=[];e.forEach(((e,a)=>{t.push((0,s.jsx)("option",{value:a,children:a},a))})),a.push((0,s.jsx)("optgroup",{id:n,label:r.Z.en[n],children:t},n))}})),a}const f=e=>{const t=(0,i.useRef)(null),a=m(e.provider)??[];return(0,s.jsxs)("div",{className:"e8819BNZ",children:[(0,s.jsx)("p",{className:"GLlbHPAN",children:"Your sets:"}),(0,s.jsxs)("div",{className:"XN7ZxQBF",children:[(0,s.jsxs)("div",{className:n,children:[(0,s.jsx)("button",{onClick:async t=>{let a;try{a=await(0,d.Dq)(!1,600)}catch(e){return void console.log(e)}if(!a||!a[0])return;let s,n,r=(0,u.getStorageBonusSets)();try{s=await(0,d.$4)(a[0])}catch(e){return void console.log(e)}if(s&&0!==s.length){try{const e=c.M.parse(s);n=c.M.isTypes(e,o.F,h.XH)?e:void 0}catch(e){return void console.log("Wrong type of file!")}if(confirm('Do you want to SAVE all your previous setups?\n"OK" to ADD new setups, "Cancel" to CLEAR and ADD')){const e=confirm('Do you want to override setups on name conflict?\n"Cancel" to add with new names');n.data.forEach(((t,a)=>{t.forEach(((t,s)=>{let n=s;e||(n=function(e,t,a){let s=t,n=0;for(;e.getElement(s,a);){if(n>999)throw new Error("Something went wrong with indexing new setup");n++,s=t.concat("(",n.toString(),")")}return s}(r,s,a)),r.setObject(t,a,n)}))}))}else r=new c.M(n);r.data.forEach(((e,t)=>{const a=Array.from(e),s=JSON.stringify(a);localStorage.setItem(l.Z+t,s)})),e.updateCallback()}else alert("There is nothing to import")},children:"Import"}),(0,s.jsx)("button",{onClick:()=>{const e=(0,u.getStorageBonusSets)();if(0===e.data.size)return;const t=c.M.toArray(e),a=JSON.stringify(t);let s=new File([a],"bonuses.json",{type:"text/plain:charset=UTF-8"});(0,d.Xo)(s)},children:"Export"}),(0,s.jsx)("button",{onClick:()=>{confirm("Do you want to DELETE ALL your bonuses?")&&o.B.forEach((e=>{localStorage.removeItem(l.Z+e)})),e.updateCallback()},children:"Clear"})]}),(0,s.jsxs)("div",{className:n,children:[(0,s.jsx)("button",{onClick:()=>{const{groupName:a,name:s}=p(t.current);if(a&&s&&e.provider.getElement(s,a)){const t=e.provider.getElement(s,a);t&&confirm("Do you want to load set? It will reset current preset.")&&e.loadCallback(t.items)}},children:"Load"}),(0,s.jsx)("button",{onClick:()=>{const{groupName:a,name:s}=p(t.current);if(a&&s){const t=localStorage.getItem(l.Z+a),n=JSON.parse(t);if(!(0,u.isArrayLikeBonusGroup)(n))return;const r=new Map(n);if(r.delete(s)&&0!==r.size){const e=JSON.stringify(Array.from(r));localStorage.setItem(l.Z+a,e)}else 0===r.size&&localStorage.removeItem(l.Z+a);e.updateCallback()}},children:"Delete"})]})]}),(0,s.jsx)("select",{ref:t,className:"On3iX0ix",name:"fruit",size:10,children:a})]})}},612:(e,t,a)=>{a.d(t,{CV:()=>s,IB:()=>n,zk:()=>r});const s=["baseatk","basehp","basedef"],n=["crrate","crdmg","atkIncrease","hpIncrease","defIncrease","flatatk","flathp","flatdef","dmgIncrease","elemIncrease","defIgnore","resPen"];class r{constructor(e="basic",t="fire",a="atk",s={multiplier:0,baseatk:0,basehp:0,basedef:0},n={crrate:.05,crdmg:.5,flatatk:352,flathp:0,flatdef:0,breakeffect:0,atkIncrease:0,hpIncrease:0,defIncrease:0,elemIncrease:0,dmgIncrease:0,defIgnore:0,resPen:0}){this.atkType=e??"basic",this.element=t??"fire",this.srcStat=a??"atk";for(const e of Object.keys({multiplier:0,baseatk:0,basehp:0,basedef:0}))void 0===s[e]&&(s[e]=0);this.stats=s;for(const e of Object.keys({crrate:.05,crdmg:.5,flatatk:352,flathp:0,flatdef:0,breakeffect:0,atkIncrease:0,hpIncrease:0,defIncrease:0,elemIncrease:0,dmgIncrease:0,defIgnore:0,resPen:0}))void 0===n[e]&&(n[e]=0,console.log());this.buffs=n}getCharObj(){return{atkType:this.atkType,element:this.element,srcStat:this.srcStat,stats:this.stats,buffs:this.buffs}}getCharTotalAtk(){return Math.floor(this.stats[`base${this.srcStat}`]*(1+this.buffs[`${this.srcStat}Increase`])+this.buffs[`flat${this.srcStat}`])}}},760:(e,t,a)=>{a.d(t,{C8:()=>n,vW:()=>s});const s=["defReduction","resReduction","dmgTakenIncrease"];class n{constructor(e=95,t="fire",a={hp:0,def:0,res:0},s={defReduction:0,resReduction:0,dmgTakenIncrease:0},n=!1){this._lvl=e,this._element=t,this._stats=a,this._debuffs=s,this._isBroken=n,this.updateDefByLvl()}updateDefByLvl(){this._stats.def=200+10*this._lvl}get lvl(){return this._lvl}get element(){return this._element}get stats(){return this._stats}get debuffs(){return this._debuffs}get isBroken(){return this._isBroken}set lvl(e){this._lvl=e,this.updateDefByLvl()}set element(e){this._element=e}set stats(e){this._stats=e}set debuffs(e){this._debuffs=e}set isBroken(e){this._isBroken=e}getEnemyObj(){return{lvl:this.lvl,element:this.element,stats:this.stats,debuffs:this._debuffs,isBroken:this._isBroken}}}},843:(e,t,a)=>{a.d(t,{E:()=>n});var s=a(893);const n=e=>(0,s.jsx)("p",{className:"J6P9uriy",children:"%"})},177:(e,t,a)=>{a.d(t,{d:()=>s,l:()=>n});const s=["atk","hp","def"],n=["fire","ice","lightning","physical","quantum","imaginary","wind"]},268:(e,t,a)=>{a.d(t,{Hy:()=>o,Lx:()=>l,XH:()=>i,wu:()=>n});var s=a(814);function n(e,t,a,n,i,l){if(!a&&Number.isNaN(Number(n))&&!i&&!l||Number.isNaN(Number(t)))throw new Error("Something went wrong! origin: getBonusSet()");const o=e.find((e=>e.id===t));if(o){const c=e.indexOf(o),u=[...e],d=a??o.key;let h=Number.isNaN(Number(n))?o.value:Number(n);a&&(0,s.hU)(o.key)!==(0,s.hU)(a)&&(h=0);let p=i??o.atkTypeOption,m=l??o.elemTypeOption;if(a){const e=r(a);p=e.atkTypeOption,m=e.elemTypeOption}return"dot"!==i||s.Wv.includes(l)||(m=s.YU[0]),u[c]={id:t,key:d,value:h,atkTypeOption:p,elemTypeOption:m},u}{if(Number.isNaN(Number(t)))throw new Error("Invalid ID for new set");const s=a??"crrate",i=Number.isNaN(Number(n))?0:Number(n),l=r(a),o=l.atkTypeOption,c=l.elemTypeOption;return[...e,{id:t,key:s,value:i,atkTypeOption:o,elemTypeOption:c}]}}function r(e){if(!e)throw new Error("Invalid key");const t={atkTypeOption:"none",elemTypeOption:"none"};return"dmgIncrease"!==e&&"dmgTakenIncrease"!==e&&"elemIncrease"!==e&&"resPen"!==e&&"resReduction"!==e||(t.atkTypeOption=s.xw[0],t.elemTypeOption=s.U6[0]),t}function i(e){return e instanceof Object&&e.hasOwnProperty("name")&&e.hasOwnProperty("type")&&e.hasOwnProperty("items")}function l(e){return e instanceof Object&&e.hasOwnProperty("isActive")&&e.hasOwnProperty("comparisonValue")&&i(e)}function o(e,t,a){return{...e,isActive:t,comparisonValue:a,items:e.items.map((e=>({...e,isActive:t,comparisonValue:a})))}}},227:(e,t,a)=>{a.d(t,{B:()=>s,F:()=>n});const s=["weapon","teammate","relics","planars","other"];function n(e){return s.includes(e)}},773:(e,t,a)=>{a.d(t,{M:()=>s});class s{constructor(e){e instanceof Array?this._map=s.fromArray(e).data:e instanceof Map?this._map=e:this._map=e instanceof s?e.data:new Map}get data(){return this._map}setObject(e,t,a){this._map.has(t)||this._map.set(t,new Map),this._map.get(t).set(a,e)}setGroupMap(e,t){this._map.set(e,t)}getElement(e,t){return this._map.has(t)?this._map.get(t).get(e):void 0}getConvertedGroupedMap(e){let t=new s;return this._map.forEach(((a,s)=>{a.forEach(((a,n)=>{const r=e(a);t.setObject(r,s,n)}))})),t}static isTypes(e,t,a){return e instanceof s&&(e.data.forEach(((e,s)=>{let n=!0;if(e.forEach((e=>{a(e)||(n=!1)})),!t(s)||!n)return!1})),!0)}unsetObject(e,t){return!!this.isObjExists(e,t)&&(this._map.get(e).delete(t),!0)}isObjExists(e,t){return this._map.has(e)&&this._map.get(e).has(t)}hasElement(e,t){return this._map.has(t)&&this._map.get(t).has(e)}getWith(e,t,a){return this.setObject(e,a,t),new s(this._map)}getWithout(e,t){return this.unsetObject(t,e),new s(this._map)}getGroupClone(e){return new Map(this._map.get(e))}static fromArray(e){function t(e){return Array.isArray(e)&&2===e.length}let a=new Map;try{e?.forEach((e=>{if(!t(e))throw new Error("Array value is invalid. Source: 'Groupedmap.fromArray()"+e);let s=new Map;e[1].forEach((e=>{if(!t(e))throw new Error("Array value is invalid. Source: 'Groupedmap.fromArray(). Params: "+e);s.set(e[0],e[1])})),a.set(e[0],s)}))}catch(e){console.log(e)}finally{return new s(a)}}static toArray(e){let t=[];return e.data.forEach(((e,a)=>{let s=Array.from(e);t.push([a,s])})),t}static stringify(e){const t=s.toArray(e);return JSON.stringify(t)}static parse(e){if(!e||0===e.length)return new s;const t=JSON.parse(e);return Array.isArray(t)?s.fromArray(t):new s}}},814:(e,t,a)=>{a.d(t,{U6:()=>i,Wv:()=>n,YU:()=>r,cE:()=>l,hU:()=>c,xw:()=>o});var s=a(177);const n=["fire","lightning","physical","wind"],r=["all",...n],i=["all",...s.l],l=["basic","skill","ultimate","talent","dot","follow-up"],o=["any",...l];function c(e){return!["baseatk","basehp","basedef","flatatk","flathp","flatdef","lvl","def"].includes(e)}},203:(e,t,a)=>{a.d(t,{Z:()=>s});const s={en:{multiplier:"Multiplier",atkType:"Attack type",element:"Element",srcStat:"Dmg source",baseatk:"Base Atk",basehp:"Base HP",basedef:"Base Def",crrate:"Crit.rate",crdmg:"Crit DMG",flatatk:"Flat Atk",flathp:"Flat HP",flatdef:"Flat Def",breakeffect:"Break effect",atkIncrease:"Atk%",hpIncrease:"HP%",defIncrease:"Def%",elemIncrease:"Elemental%",dmgIncrease:"Dmg%",defIgnore:"Def Ignore",resPen:"Res PEN",defReduction:"Def Reduction",resReduction:"Res Reduction",dmgTakenIncrease:"Dmg Taken%",basic:"Basic",skill:"Skill",ultimate:"Ultimate",talent:"Talent","follow-up":"Follow-up",dot:"DoT",any:"Any",fire:"Fire",lightning:"Lightning",physical:"Physical",wind:"Wind",ice:"Ice",quantum:"Quantum",imaginary:"Imaginary",all:"All",weapon:"Weapon",teammate:"Teammate",relics:"Relic",planars:"Planar",other:"Other"}}},245:(e,t,a)=>{a.d(t,{$:()=>s,q:()=>n});class s{static invalidCharsValidation(e){for(const t of this.invalidChars)e.replace(t,"");return e}static emptyValidation(e){return""===e?"0":e}static startWithZeroValidation(e){if(e.startsWith("0")&&!e.startsWith("0.")&&e.length>1){let t=1;for(;t<e.length-1&&"0"===e[t];)t++;return e.slice(t,e.length)}return e}static maxFloatLengthValidation(e){return e.split(".")[1]?.length>2&&(e=e.slice(0,e.length-1)),e.split(".")[0]?.length>6&&e.split(".")[1]&&(e=e.slice(1,e.length)),e.length>9&&(e=e.slice(0,e.length-1)),e}static maxIntegerLengthValidation(e){const t=e.indexOf("."),a=e.indexOf(",");if(-1!==t||-1!==a){const s=Math.min(-1===t?9:t,-1===a?9:a);e=e.slice(0,s)}return e.length>9&&(e=e.slice(0,e.length-1)),e}static parseStringValueToPercentFloat(e){return isNaN(Number(e))?0:Number((Number(e)/100).toFixed(4))}static parseStringValueToInteger(e){return isNaN(parseInt(e))?(console.log("Can't parse current value: "+e.toString()),0):parseInt(e)}static getValidatedStatData(e,t){return""===e?{valueAsString:"",valueAsNumber:0}:(e=s.invalidCharsValidation(e),e=s.startWithZeroValidation(e),{valueAsString:e=t?s.maxFloatLengthValidation(e):s.maxIntegerLengthValidation(e),valueAsNumber:t?s.parseStringValueToPercentFloat(e):s.parseStringValueToInteger(e)})}}s.invalidChars=["+","e","-"];class n{static isValidKeys(e){return!("-"===e||"+"===e||"e"===e)}static isValidLocaleSeparator(e){const t=n.localeDecimalSeparator;return!(("."===e||","===e)&&t!==e)}static isValidFormat(e,t){return!(n.localeDecimalSeparator===e&&!t)}static isValidKeyInput(e,t){return n.isValidKeys(e)&&n.isValidLocaleSeparator(e)&&n.isValidFormat(e,t)}}n.localeDecimalSeparator=1.1.toLocaleString().substring(1,2)},543:(e,t,a)=>{function s(){const e="version";localStorage.getItem(e)?.split(".")[0]!=="1.0.2".split(".")[0]&&(localStorage.clear(),localStorage.setItem(e,"1.0.2"))}a.d(t,{N:()=>s})}}]);